# ~/.bashrc: executed by bash(1) for non-login shells.
# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)
# for examples

export DOTFILES=~/.dotfiles

_log_debug() { [[ ${DOTDEBUG} == 0 ]] && echo "${@}"; }

# source one file or all files in one directory, recursively
# use like so:
#   dotsrc <filename>
#   dotsrc <directory>
dotsrc() {
    local file
    if [ -d ${1} ]; then
        _log_debug "Searching directory ${1}"
        for file in ${1}/*; do
            _log_debug "File found: ${file}"
            [[ -d "${file}" ]] && dotsrc ${file}
            [[ -f "${file}" ]] && dotsrc ${file%.sh}.sh
        done
    fi
    if [ -f "${1}" ]; then
        _log_debug "Loading file ${1}"
        source ${1}
    fi
}

loadbashrc() { 
    dotsrc ${DOTFILES}/bash/${1}.bashrc; 
}

# load custom environment variable before doing anything
if [[ -f ${HOME}/.custom_dotfiles/bashrc ]]; then
    dotsrc ${HOME}/.custom_dotfiles/bashrc
fi

[[ -z ${DOTDEBUG} ]] && DOTDEBUG=1

# Common initialization
loadbashrc common

# Load login specific utilities
if shopt -q login_shell; then
    loadbashrc login
fi

# If not running interactively, do not load interactive functions
case $- in
    *i*) ;;
      *) return ;;
esac
loadbashrc interactive
